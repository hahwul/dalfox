# Email preview, chat, and messaging XSS patterns

[[case]]
id = 5251
name = "email_html_preview"
description = "Email preview page renders HTML email body with sender info"
handler_type = "realworld"
reflection = "{input}"
expected_detection = true
page_template = "email_preview"
category = "real_world"

[[case]]
id = 5252
name = "email_subject_reflection"
description = "Email view reflects subject line in title and heading"
handler_type = "realworld"
reflection = "<html><head><title>{input}</title></head><body><h2 class=\"subject\">{input}</h2><div class=\"body\">Email content here</div><a href=\"mailto:?subject={input}\">Forward</a></body></html>"
expected_detection = true
category = "real_world"

[[case]]
id = 5253
name = "email_template_editor"
description = "Email template editor reflects template variable in preview"
handler_type = "realworld"
reflection = "<html><body><div class=\"template-preview\"><h1>Hello {input},</h1><p>Your order for {input} has been confirmed.</p><a href=\"{input}\">Track Order</a></div></body></html>"
expected_detection = true
category = "real_world"

[[case]]
id = 5254
name = "chat_room_title"
description = "Chat room page reflects room name in title and header"
handler_type = "realworld"
reflection = "{input}"
expected_detection = true
page_template = "chat_message"
category = "real_world"

[[case]]
id = 5255
name = "chat_message_display"
description = "Chat message display with strip_script but allowing basic HTML"
handler_type = "realworld"
reflection = "{input}"
expected_detection = true
filter = "strip_script"
page_template = "chat_message"
category = "real_world"

[[case]]
id = 5256
name = "notification_display"
description = "Notification panel reflects event title and action URL"
handler_type = "realworld"
reflection = "{input}"
expected_detection = true
page_template = "notification"
category = "real_world"

[[case]]
id = 5257
name = "notification_push_content"
description = "Push notification preview reflects title and body content"
handler_type = "realworld"
reflection = "<html><body><div class=\"push-preview\"><h4>{input}</h4><p>{input}</p><img src=\"/icon.png\" alt=\"{input}\"></div><script>Notification.requestPermission().then(function(){{ new Notification('{input}', {{body: '{input}'}}); }});</script></body></html>"
expected_detection = true
category = "real_world"

[[case]]
id = 5258
name = "email_strip_safe"
description = "Email preview with full tag stripping and encoding - safe"
handler_type = "realworld"
reflection = "{input}"
expected_detection = false
filter = "strip_tags|encode_angles"
page_template = "email_preview"
category = "real_world"
