# Header injection test cases

[[case]]
id = 1
name = "raw_reflection"
description = "Direct reflection without any encoding"
handler_type = "header"
header_name = "X-Test"
reflection = "{input}"
expected_detection = true

[[case]]
id = 2
name = "html_named_encode"
description = "HTML entity encoding (named)"
handler_type = "header"
header_name = "X-Test"
reflection = "encoded_html_named"
expected_detection = true

[[case]]
id = 3
name = "html_hex_lower"
description = "HTML numeric hex encoding (lowercase)"
handler_type = "header"
header_name = "X-Test"
reflection = "encoded_html_hex_lower"
expected_detection = true

[[case]]
id = 4
name = "html_hex_upper"
description = "HTML numeric hex encoding (uppercase X)"
handler_type = "header"
header_name = "X-Test"
reflection = "encoded_html_hex_upper"
expected_detection = true

[[case]]
id = 5
name = "percent_encode"
description = "Percent sign encoded"
handler_type = "header"
header_name = "X-Test"
reflection = "percent_to_entity"
expected_detection = true

[[case]]
id = 6
name = "base64_encode"
description = "Base64 encoding"
handler_type = "header"
header_name = "X-Test"
reflection = "encoded_base64"
expected_detection = true

[[case]]
id = 7
name = "url_encode"
description = "URL encoding"
handler_type = "header"
header_name = "X-Test"
reflection = "encoded_url"
expected_detection = true

[[case]]
id = 8
name = "div_element"
description = "Reflection inside div element"
handler_type = "header"
header_name = "X-Test"
reflection = "<div>{input}</div>"
expected_detection = true

[[case]]
id = 9
name = "script_block"
description = "Reflection inside script block"
handler_type = "header"
header_name = "X-Test"
reflection = "<script>{input}</script>"
expected_detection = true

[[case]]
id = 10
name = "html_comment"
description = "Reflection inside HTML comment"
handler_type = "header"
header_name = "X-Test"
reflection = "<!-- {input} -->"
expected_detection = true

[[case]]
id = 11
name = "custom_header_user_agent"
description = "User-Agent header reflection"
handler_type = "header"
header_name = "User-Agent"
reflection = "<div>UA: {input}</div>"
expected_detection = true

[[case]]
id = 12
name = "custom_header_referer"
description = "Referer header reflection"
handler_type = "header"
header_name = "Referer"
reflection = "<a href=\"{input}\">Back</a>"
expected_detection = true
